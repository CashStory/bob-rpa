var bobRpa=function(e){var n={};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=5)}({1:function(e,n,o){"use strict";o.d(n,"a",(function(){return y})),o.d(n,"b",(function(){return v}));var t=()=>{const e=[];let n=!1;return{destroy(o){n=!0,e.forEach(e=>{e(o)})},onDestroy(o){n?o():e.push(o)}}};const r={"http:":"80","https:":"443"},i=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,s=["file:","data:"];var c,a,d,l,u,f=e=>(...n)=>{e&&console.log("[Penpal]",...n)};!function(e){e.Call="call",e.Reply="reply",e.Syn="syn",e.SynAck="synAck",e.Ack="ack"}(c||(c={})),function(e){e.Fulfilled="fulfilled",e.Rejected="rejected"}(a||(a={})),function(e){e.ConnectionDestroyed="ConnectionDestroyed",e.ConnectionTimeout="ConnectionTimeout",e.NotInIframe="NotInIframe",e.NoIframeSrc="NoIframeSrc"}(d||(d={})),function(e){e.DataCloneError="DataCloneError"}(l||(l={})),function(e){e.Message="message"}(u||(u={}));const g=({name:e,message:n,stack:o})=>({name:e,message:n,stack:o});var m=(e,n,o)=>{const{localName:t,local:r,remote:i,originForSending:s,originForReceiving:d}=e;let f=!1;const m=e=>{if(e.source!==i||e.data.penpal!==c.Call)return;if(e.origin!==d)return void o(`${t} received message from origin ${e.origin} which did not match expected origin ${d}`);const r=e.data,{methodName:u,args:m,id:p}=r;o(`${t}: Received ${u}() call`);const h=e=>n=>{if(o(`${t}: Sending ${u}() reply`),f)return void o(`${t}: Unable to send ${u}() reply due to destroyed connection`);const r={penpal:c.Reply,id:p,resolution:e,returnValue:n};e===a.Rejected&&n instanceof Error&&(r.returnValue=g(n),r.returnValueIsError=!0);try{i.postMessage(r,s)}catch(e){if(e.name===l.DataCloneError){const n={penpal:c.Reply,id:p,resolution:a.Rejected,returnValue:g(e),returnValueIsError:!0};i.postMessage(n,s)}throw e}};new Promise(e=>e(n[u].apply(n,m))).then(h(a.Fulfilled),h(a.Rejected))};return r.addEventListener(u.Message,m),()=>{f=!0,r.removeEventListener(u.Message,m)}};let p=0;var h=(e,n,o,t,r)=>{const{localName:i,local:s,remote:l,originForSending:f,originForReceiving:g}=n;let m=!1;r(i+": Connecting call sender");const h=e=>(...n)=>{let o;r(`${i}: Sending ${e}() call`);try{l.closed&&(o=!0)}catch(e){o=!0}if(o&&t(),m){const n=new Error(`Unable to send ${e}() call due to destroyed connection`);throw n.code=d.ConnectionDestroyed,n}return new Promise((o,t)=>{const d=++p,m=n=>{if(n.source!==l||n.data.penpal!==c.Reply||n.data.id!==d)return;if(n.origin!==g)return void r(`${i} received message from origin ${n.origin} which did not match expected origin ${g}`);const f=n.data;r(`${i}: Received ${e}() reply`),s.removeEventListener(u.Message,m);let p=f.returnValue;f.returnValueIsError&&(p=(e=>{const n=new Error;return Object.keys(e).forEach(o=>n[o]=e[o]),n})(p)),(f.resolution===a.Fulfilled?o:t)(p)};s.addEventListener(u.Message,m);const h={penpal:c.Call,id:d,methodName:e,args:n};l.postMessage(h,f)})};return o.reduce((e,n)=>(e[n]=h(n),e),e),()=>{m=!0}};var w=(e,n)=>{let o;return void 0!==e&&(o=window.setTimeout(()=>{const o=new Error(`Connection timed out after ${e}ms`);o.code=d.ConnectionTimeout,n(o)},e)),()=>{clearTimeout(o)}},y=e=>{let{iframe:n,methods:o={},childOrigin:a,timeout:l,debug:g=!1}=e;const p=f(g),y=t(),{onDestroy:v,destroy:S}=y;a||((e=>{if(!e.src&&!e.srcdoc){const e=new Error("Iframe must have src or srcdoc property defined.");throw e.code=d.NoIframeSrc,e}})(n),a=(e=>{if(e&&s.find(n=>e.startsWith(n)))return"null";const n=document.location,o=i.exec(e);let t,c,a;o?(t=o[1]?o[1]:n.protocol,c=o[2],a=o[4]):(t=n.protocol,c=n.hostname,a=n.port);return`${t}//${c}${a&&a!==r[t]?":"+a:""}`})(n.src));const C="null"===a?"*":a,E=((e,n,o,t)=>r=>{if(r.origin!==o)return void e(`Parent: Handshake - Received SYN message from origin ${r.origin} which did not match expected origin ${o}`);e("Parent: Handshake - Received SYN, responding with SYN-ACK");const i={penpal:c.SynAck,methodNames:Object.keys(n)};r.source.postMessage(i,t)})(p,o,a,C),$=((e,n,o,t,r)=>{const{destroy:i,onDestroy:s}=t;let c,a;const d={};return t=>{if(t.origin!==n)return void r(`Parent: Handshake - Received ACK message from origin ${t.origin} which did not match expected origin ${n}`);r("Parent: Handshake - Received ACK");const l={localName:"Parent",local:window,remote:t.source,originForSending:o,originForReceiving:n};c&&c(),c=m(l,e,r),s(c),a&&a.forEach(e=>{delete d[e]}),a=t.data.methodNames;const u=h(d,l,a,i,r);return s(u),d}})(o,a,C,y,p);return{promise:new Promise((e,o)=>{const t=w(l,S),r=o=>{if(o.source===n.contentWindow&&o.data)if(o.data.penpal!==c.Syn)if(o.data.penpal!==c.Ack);else{const n=$(o);n&&(t(),e(n))}else E(o)};window.addEventListener(u.Message,r),p("Parent: Awaiting handshake"),((e,n)=>{const{destroy:o,onDestroy:t}=n,r=setInterval(()=>{document.contains(e)||(clearInterval(r),o())},6e4);t(()=>{clearInterval(r)})})(n,y),v(e=>{window.removeEventListener(u.Message,r),e||((e=new Error("Connection destroyed")).code=d.ConnectionDestroyed),o(e)})}),destroy(){S()}}};var v=(e={})=>{const{parentOrigin:n="*",methods:o={},timeout:r,debug:i=!1}=e,s=f(i),a=t(),{destroy:l,onDestroy:g}=a;(()=>{if(window===window.top){const e=new Error("connectToParent() must be called within an iframe");throw e.code=d.NotInIframe,e}})();const p=((e,n,o,t)=>{const{destroy:r,onDestroy:i}=o;return o=>{if(!(e instanceof RegExp?e.test(o.origin):"*"===e||e===o.origin))return void t(`Child: Handshake - Received SYN-ACK from origin ${o.origin} which did not match expected origin ${e}`);t("Child: Handshake - Received SYN-ACK, responding with ACK");const s="null"===o.origin?"*":o.origin,a={penpal:c.Ack,methodNames:Object.keys(n)};window.parent.postMessage(a,s);const d={localName:"Child",local:window,remote:window.parent,originForSending:s,originForReceiving:o.origin},l=m(d,n,t);i(l);const u={},f=h(u,d,o.data.methodNames,r,t);return i(f),u}})(n,o,a,s);return{promise:new Promise((e,o)=>{const t=w(r,l),i=n=>{if((()=>{try{clearTimeout()}catch(e){return!1}return!0})()&&n.source===parent&&n.data&&n.data.penpal===c.SynAck){const o=p(n);o&&(window.removeEventListener(u.Message,i),t(),e(o))}};window.addEventListener(u.Message,i),(()=>{s("Child: Handshake - Sending SYN");const e={penpal:c.Syn},o=n instanceof RegExp?"*":n;window.parent.postMessage(e,o)})(),g(e=>{window.removeEventListener(u.Message,i),e||((e=new Error("Connection destroyed")).code=d.ConnectionDestroyed),o(e)})}),destroy(){l()}}}},5:function(e,n,o){"use strict";o.r(n);var t=o(1),r=document.getElementById("iframe_rpa"),i=Object(t.a)({iframe:r,debug:!0,methods:{getName:function(){return"test Name"},getZoomPercentage:function(){return"100"},needLogin:function(){return{login:"test login",pwd:"test password"}}}});i.promise.then((function(e){e.hideElements(["app"]).then((function(e){return console.log("hideElements",e)})),e.showElements(["app"]).then((function(e){return console.log("showElements",e)})),e.switchCSLoader("on").then((function(e){return console.log("switchCSLoader on",e)})),e.switchCSLoader("off").then((function(e){return console.log("switchCSLoader off",e)})),e.injectCSHTML("off").then((function(e){return console.log("injectCSHTML off",e)})),e.removeCSHTML("off").then((function(e){return console.log("removeCSHTML off",e)})),e.injectCSCSS("off").then((function(e){return console.log("injectCSCSS off",e)})),e.removeCSCSS("off").then((function(e){return console.log("removeCSCSS off",e)}))})),n.default=i}});